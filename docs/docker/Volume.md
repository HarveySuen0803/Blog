# volume

volume is the preferred mechanism for persisting data generated by and used by Docker container

bind mount is dependent on the directory structure and OS of the host machine, volume is completely managed by Docker

- volumes is easier to back up or migrate than bind mount
- we can manage volume using Docker CLI commands or the Docker API
- volume works on both Linux and Windows container
- volume can be more safely shared among multiple containers
- volume driver let you store volume on remote host or cloud provider, to encrypt the content of volume, or to add other functionality
- new volume can have their content pre-populated by a container
- volume on Docker Desktop have much higher performance than bind mount from Mac and Windows host

# volume command

```shell
# list volume
docker volume list

# create volume, volume name is html, path is /var/lib/docker/volumes/html
docker volume create html

# inspect volume
docker volume inspect html

# delete volume
docker volume remove html

# delete all unused volume
docker volume prune

# edit volume
nvim /var/lib/docker/volumes/html/_data/index.html

# mount volume
docker run --name my-nginx -p 80:80 -v html:/user/share/nginx/html -d nginx
docker run --name my-nginx -p 80:80 -v /tmp/html:/user/share/nginx/html -d nginx

# solve error (cannot open directory: Permission denied)
docker run --name my-nginx -p 80:80 -v html:/user/share/nginx/html --privileged=true -d nginx

# set read and write permissions for volume
#   ro  read only
#   rw (def)  read and write
docker run --name my-nginx -p 80:80 -v html:/user/share/nginx/html:ro --privileged=true -d nginx
docker run --name my-nginx -p 80:80 -v html:/user/share/nginx/html:rw --privileged=true -d nginx

# inherit volume, sharing volume
docker run --name my-sub-nginx -p 81:81 --volumes-from my-nginx -d nginx
```